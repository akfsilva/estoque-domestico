<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Estoque Doméstico</title>

<link rel="manifest" href="manifest.json">
<link rel="icon" href="icon-192.png">

<style>
:root {
  --bg:#0b1a12;
  --panel:#102a1c;
  --text:#b6ffb6;
  --accent:#4cff4c;
  --warning:#ffcc00;
  --danger:#ff5555;
  --border:#2cff6a;
}

* { box-sizing:border-box; font-family:"Courier New", monospace; }

body {
  margin:0;
  background:var(--bg);
  color:var(--text);
}

header {
  display:flex;
  align-items:center;
  gap:12px;
  padding:16px;
  border-bottom:2px solid var(--border);
}

header img {
  width:48px;
  height:48px;
  image-rendering:pixelated;
}

h1 { margin:0; font-size:1.4rem; }

main { padding:16px; }

section {
  background:var(--panel);
  border:2px solid var(--border);
  padding:12px;
  margin-bottom:16px;
}

h2 {
  margin-top:0;
  font-size:1.1rem;
  border-bottom:1px solid var(--border);
  padding-bottom:4px;
}

input, button {
  background:black;
  color:var(--text);
  border:1px solid var(--border);
  padding:6px;
  margin:4px 0;
}

button { cursor:pointer; }

button.danger {
  color:var(--danger);
  border-color:var(--danger);
}

.item {
  border-bottom:1px dashed var(--border);
  padding:8px 0;
}

.item:last-child { border-bottom:none; }

strong { color:var(--accent); }

.progress {
  background:black;
  border:1px solid var(--border);
  height:14px;
  margin-top:6px;
}

.progress-bar {
  height:100%;
  background:var(--accent);
}

.progress.low .progress-bar { background:var(--danger); }
.progress.mid .progress-bar { background:var(--warning); }

.alert {
  color:var(--danger);
  font-size:0.85rem;
  margin-top:4px;
}
</style>
</head>

<body>

<header>
  <img src="icon-192.png">
  <h1>Estoque Doméstico</h1>
</header>

<main>

<section>
<h2>Adicionar item</h2>
<input id="name" placeholder="Nome do item">
<input id="category" placeholder="Categoria">
<input id="qty" type="number" placeholder="Qtd atual">
<input id="goal" type="number" placeholder="Meta anual">
<br>
<button onclick="addItem()">Adicionar</button>
</section>

<section>
<h2>Itens em estoque</h2>
<div id="list"></div>
</section>

</main>

<script>
const KEY="estoque_domestico";

let items = JSON.parse(localStorage.getItem(KEY)) || [
  {id:1,name:"Arroz",category:"Alimentos",qty:2,goal:12},
  {id:2,name:"Feijão",category:"Alimentos",qty:1,goal:12},
  {id:3,name:"Macarrão",category:"Alimentos",qty:4,goal:12},
  {id:4,name:"Papel toalha",category:"Limpeza",qty:2,goal:6}
];

function save(){
  localStorage.setItem(KEY,JSON.stringify(items));
}

function addItem(){
  const name=document.getElementById("name").value.trim();
  if(!name) return;

  items.push({
    id:Date.now(),
    name,
    category:category.value||"Outros",
    qty:Number(qty.value)||0,
    goal:Number(goal.value)||0
  });

  save(); render();
  name.value=category.value=qty.value=goal.value="";
}

function updateQty(id,val){
  items.find(i=>i.id===id).qty=Number(val);
  save(); render();
}

function updateGoal(id,val){
  items.find(i=>i.id===id).goal=Number(val);
  save(); render();
}

function removeItem(id){
  items=items.filter(i=>i.id!==id);
  save(); render();
}

function render(){
  const list=document.getElementById("list");
  list.innerHTML="";

  items.forEach(i=>{
    const pct=i.goal?Math.min(100,(i.qty/i.goal)*100):0;
    let cls="progress";
    let alert="";

    if(pct<30){ cls+=" low"; alert="⚠ Estoque crítico"; }
    else if(pct<60){ cls+=" mid"; }

    list.innerHTML+=`
    <div class="item">
      <strong>${i.name}</strong> [${i.category}]<br>
      Atual: <input type="number" value="${i.qty}" onchange="updateQty(${i.id},this.value)">
      Meta: <input type="number" value="${i.goal}" onchange="updateGoal(${i.id},this.value)">
      <div class="${cls}">
        <div class="progress-bar" style="width:${pct}%"></div>
      </div>
      ${alert?`<div class="alert">${alert}</div>`:""}
      <button class="danger" onclick="removeItem(${i.id})">Excluir</button>
    </div>`;
  });
}

render();
</script>

</body>
</html>
